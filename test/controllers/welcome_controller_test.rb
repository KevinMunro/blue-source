require 'test_helper'

class WelcomeControllerTest < ActionController::TestCase
  test 'test_saml' do
    employee = employees(:saml_tester)
    response = 'PHNhbWxwOlJlc3BvbnNlIElEPSJfODg4MDkyZDktZTVmYy00ZmNmLTkwODgtZTkwNmI4YTgwMzAwIiBWZXJzaW9uPSIyLjAiIElzc3VlSW5zdGFudD0iMjAxNC0wOS0yNlQxNzowMzo1NS40NTJaIiBEZXN0aW5hdGlvbj0iaHR0cHM6Ly9ibHVlc291cmNlLm9yYXNpLmNvbS9hdXRoL3NhbWwvY2FsbGJhY2siIENvbnNlbnQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpjb25zZW50OnVuc3BlY2lmaWVkIiBJblJlc3BvbnNlVG89Il8wNWJiMDI4MC0yN2NkLTAxMzItMzE4Mi0yODIwNjYyNzIwOWQiIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiPjxJc3N1ZXIgeG1sbnM9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iPmh0dHA6Ly9hZGZzLm9yYXNpLmNvbS9hZGZzL3NlcnZpY2VzL3RydXN0PC9Jc3N1ZXI+PHNhbWxwOlN0YXR1cz48c2FtbHA6U3RhdHVzQ29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1czpTdWNjZXNzIiAvPjwvc2FtbHA6U3RhdHVzPjxBc3NlcnRpb24gSUQ9Il8wYjhhNWQwMy0xZmU4LTQyMzQtODcyOC0wYWQ3MDE2OWFlZTUiIElzc3VlSW5zdGFudD0iMjAxNC0wOS0yNlQxNzowMzo1NS40NTJaIiBWZXJzaW9uPSIyLjAiIHhtbG5zPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj48SXNzdWVyPmh0dHA6Ly9hZGZzLm9yYXNpLmNvbS9hZGZzL3NlcnZpY2VzL3RydXN0PC9Jc3N1ZXI+PGRzOlNpZ25hdHVyZSB4bWxuczpkcz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyI+PGRzOlNpZ25lZEluZm8+PGRzOkNhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiIC8+PGRzOlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI3JzYS1zaGEyNTYiIC8+PGRzOlJlZmVyZW5jZSBVUkk9IiNfMGI4YTVkMDMtMWZlOC00MjM0LTg3MjgtMGFkNzAxNjlhZWU1Ij48ZHM6VHJhbnNmb3Jtcz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiIC8+PGRzOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIgLz48L2RzOlRyYW5zZm9ybXM+PGRzOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTI1NiIgLz48ZHM6RGlnZXN0VmFsdWU+a0FMMjFqU2xSbTBOcU9ob0tLU1BCTGFWUVU3N0EvMis2eG04YU9oWTRvOD08L2RzOkRpZ2VzdFZhbHVlPjwvZHM6UmVmZXJlbmNlPjwvZHM6U2lnbmVkSW5mbz48ZHM6U2lnbmF0dXJlVmFsdWU+V2hocnluZTl5RExPcHNvQ1hWS2g4cVFDTC9Ncjd3eG1Md1VyUFNjTHNYZzMvNElsUCtVbjlpYUkydXVvM05oMXc4bitTcDFic0ljVkVnZmQ0MllWWUwrQThINC93MVZqS2dpN3pQV3liUFQxQ2V0b24zSEJYVEtCSDZHYXBWUHhLTFVrWEhkNW9yUWVhY2pmdjIrcUkxZjk3dytnb29YUS9KR3prejFTTWxqMy95NVhUYWdOdUFwTnRHMlU0dWhPSDJ3N2NrZHFSZkI1dWdGcFBWcjF6eThWUnBVSkRlc2h5bkhwNytyc1VRVTQyYTBOTDB5V0xlVVZOeVpNYVZEVjh0bjNwNUZkajJObkl0alFZZllCQzZPWjRGVzNsUVIvdkVmcHBYekVBcXo2UW4zcXlGeWZVRGltNmhlVEVuZVFaYW1naHZBWDI3UzZ0UlU4UEJtekVnPT08L2RzOlNpZ25hdHVyZVZhbHVlPjxLZXlJbmZvIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj48ZHM6WDUwOURhdGE+PGRzOlg1MDlDZXJ0aWZpY2F0ZT5NSUlDMkRDQ0FjQ2dBd0lCQWdJUWNvQkNSRitncTVKUFJabWpCMk5tQ0RBTkJna3Foa2lHOXcwQkFRc0ZBREFvTVNZd0pBWURWUVFERXgxQlJFWlRJRk5wWjI1cGJtY2dMU0JoWkdaekxtOXlZWE5wTG1OdmJUQWVGdzB4TkRBeE1qQXhORFEyTUROYUZ3MHhOVEF4TWpBeE5EUTJNRE5hTUNneEpqQWtCZ05WQkFNVEhVRkVSbE1nVTJsbmJtbHVaeUF0SUdGa1puTXViM0poYzJrdVkyOXRNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXB0eFp2LzI0WS8vRnVnYklZdG84QlpYSVhRWlUyZncrMmtHK2dXSko3RGJ6cVI1WGdaWmtGN0pCRVFGdmNGUHQ0K2gzdUY3Y0E1TkgxcHhmZkNURFc1c3ZhSkhRbit0aGc5NXBnMG0rdk14SXVkQ05pSHQrOXg0alpaLzJlZVhVSm04K2MwNkl3YXNaaVROaTE0VUxCVkJVc080cEFwRGtDVEVQckp0d0RUVWFoZHU5Z29McjRlM3lhTmt1ZmhZdS9oYmRpVmxWRlZMZVdxS3FuNjJlZXhDY29zV3pwc045QTFSbS85VXpmQmZPVHEvbnIxZWt0SkduY1RzK3FSUVNFYkxYY1Y1OVBVZlk2YXhKMkRLSEIwaG1iak5IWFdwTnlieGtXUGI4V25Mek8yMThZaDA4K2FoR2FYOUlNWHI5UGFXK0x6blVJd1cvMnJPR1YvRGJtUUlEQVFBQk1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQXRrTHhqcFcrZ09SWWhBdEpZTUdPR2EzNC95TkZ1OEtRODJJaW9wUGdUdTYwU0hrTmpkeDVaSWE2N0laeTJjWlpvdXV0TXlNYjN1T2Q0ZS9jNmZWY2ZtNHVuUmJrZEt4WHRlck1lTktBV2VWWkozQllBM09BbW9VVG00YWwzUFl6R3Y1d0pVeHJ1eGlNZStBMi9haGVEZHVEbGRqTnRiQTQzTHRvVnNldHNIa0laYjJRRVBIYms0bUNIRGNtTksxazV1ejBqbmVsYWNuSC9sUnRMTzNuRVJ6RmRSMS9tYml5Y2NOMWRPM1R3VktLUUVTeUh4L3dUV0hnTjMyQnNGNFd4aHhwVFhqSVhnM1lDaXZvb3hVVDl3NTBOQjRKVmZtcWs4ZmZHL0hkdWtIYm1ZaEJjZlM0SHlwWkM3Wkp1Z0E3bitaR0NpTW1USVBvTVhRc2hnaGhKPC9kczpYNTA5Q2VydGlmaWNhdGU+PC9kczpYNTA5RGF0YT48L0tleUluZm8+PC9kczpTaWduYXR1cmU+PFN1YmplY3Q+PE5hbWVJRD5sZXdpcy5nb3Jkb248L05hbWVJRD48U3ViamVjdENvbmZpcm1hdGlvbiBNZXRob2Q9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpjbTpiZWFyZXIiPjxTdWJqZWN0Q29uZmlybWF0aW9uRGF0YSBJblJlc3BvbnNlVG89Il8wNWJiMDI4MC0yN2NkLTAxMzItMzE4Mi0yODIwNjYyNzIwOWQiIE5vdE9uT3JBZnRlcj0iMjAxNC0wOS0yNlQxNzowODo1NS40NTJaIiBSZWNpcGllbnQ9Imh0dHBzOi8vYmx1ZXNvdXJjZS5vcmFzaS5jb20vYXV0aC9zYW1sL2NhbGxiYWNrIiAvPjwvU3ViamVjdENvbmZpcm1hdGlvbj48L1N1YmplY3Q+PENvbmRpdGlvbnMgTm90QmVmb3JlPSIyMDE0LTA5LTI2VDE3OjAzOjU1LjQzNloiIE5vdE9uT3JBZnRlcj0iMjAxNC0wOS0yNlQxODowMzo1NS40MzZaIj48QXVkaWVuY2VSZXN0cmljdGlvbj48QXVkaWVuY2U+aHR0cHM6Ly9ibHVlc291cmNlLm9yYXNpLmNvbTwvQXVkaWVuY2U+PC9BdWRpZW5jZVJlc3RyaWN0aW9uPjwvQ29uZGl0aW9ucz48QXV0aG5TdGF0ZW1lbnQgQXV0aG5JbnN0YW50PSIyMDE0LTA5LTI2VDE3OjAzOjQ3LjA3MFoiIFNlc3Npb25JbmRleD0iXzBiOGE1ZDAzLTFmZTgtNDIzNC04NzI4LTBhZDcwMTY5YWVlNSI+PEF1dGhuQ29udGV4dD48QXV0aG5Db250ZXh0Q2xhc3NSZWY+dXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFjOmNsYXNzZXM6UGFzc3dvcmRQcm90ZWN0ZWRUcmFuc3BvcnQ8L0F1dGhuQ29udGV4dENsYXNzUmVmPjwvQXV0aG5Db250ZXh0PjwvQXV0aG5TdGF0ZW1lbnQ+PC9Bc3NlcnRpb24+PC9zYW1scDpSZXNwb25zZT4='
    post :validate, { SAMLResponse: response }, current_user_id: employee.id
    assert_redirected_to view_employee_vacations_path(employee)

    assert_equal employee.id, @controller.session[:current_user_id]
  end
end
